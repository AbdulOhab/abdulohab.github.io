let fuse,resList=document.getElementById("searchResults"),sInput=document.getElementById("searchInput"),first,last,current_elem=null,resultsAvailable=!1;window.onload=function(){let e=new XMLHttpRequest;e.onreadystatechange=function(){if(e.readyState===4)if(e.status===200){{let t=JSON.parse(e.responseText);if(t){let e={distance:100,threshold:.4,ignoreLocation:!0,keys:["title","permalink","summary","content","date","readingTime","wordCount"]};fuse=new Fuse(t,e)}}}else console.log("Error loading search index:",e.responseText)},e.open("GET","/index.json"),e.send()};function reset(){resultsAvailable=!1,resList.innerHTML="",sInput.value="",document.getElementById("searchResultsHeader").style.display="none",document.getElementById("noResults").classList.add("hidden"),sInput.focus()}sInput.onkeyup=function(){if(fuse&&this.value.trim().length>0){let e=fuse.search(this.value.trim());if(e.length!==0){let t="";for(let s=0;s<Math.min(e.length,10);s++){let n=e[s].item,o="";if(n.date)try{const e=new Date(n.date);isNaN(e.getTime())||(o=e.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}))}catch(e){console.log("Date parsing error:",e)}t+=`
                    <li>
                        <article class="overflow-hidden transition-all duration-300 border border-gray-200 shadow-sm cursor-pointer bg-slate-200 group dark:bg-gray-800 rounded-xl hover:shadow-xl dark:border-gray-700">
                            <a href="${n.permalink}" class="block p-4">
                                <!-- Article Header -->
                                <header class="mb-3">
                                    <h1 class="mb-2 text-xl font-bold text-gray-900 transition-colors duration-200 md:text-2xl dark:text-white group-hover:text-blue-600 dark:group-hover:text-blue-400">
                                        ${n.title}
                                    </h1>
                                </header>

                                <!-- Article Summary -->
                                ${n.summary?`
                                <div class="mb-4">
                                    <p class="text-lg leading-relaxed text-gray-600 dark:text-gray-300">
                                        ${n.summary.length>300?n.summary.substring(0,300)+"...":n.summary} 
                                        <span class="text-blue-600 dark:text-blue-400">Read More</span>
                                    </p>
                                </div>
                                `:""}

                                <!-- Article Meta -->
                                <footer class="flex flex-wrap items-center gap-4 pt-3 text-sm text-gray-500 border-t border-gray-300 dark:text-gray-400 dark:border-gray-700">
                                    <!-- Date -->
                                    ${o?`
                                    <div class="flex items-center gap-2">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z">
                                            </path>
                                        </svg>
                                        <span class="font-medium">${o}</span>
                                    </div>
                                    `:""}

                                    <!-- Reading Time -->
                                    ${n.readingTime?`
                                    <div class="flex items-center gap-2">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                        </svg>
                                        <span>${n.readingTime} min</span>
                                    </div>
                                    `:""}

                                    <!-- Word Count -->
                                    ${n.wordCount?`
                                    <div class="flex items-center gap-2">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z">
                                            </path>
                                        </svg>
                                        <span>${n.wordCount} words</span>
                                    </div>
                                    `:""}
                                </footer>
                            </a>
                        </article>
                    </li>
                `}resList.innerHTML=t,document.getElementById("searchResultsHeader").style.display="block",document.getElementById("noResults").classList.add("hidden"),resultsAvailable=!0,first=resList.firstChild,last=resList.lastChild}else resList.innerHTML="",document.getElementById("searchResultsHeader").style.display="none",document.getElementById("noResults").classList.remove("hidden"),resultsAvailable=!1}else reset()},sInput.addEventListener("keydown",function(e){e.key==="Escape"&&reset()}),sInput.addEventListener("search",function(){this.value||reset()}),document.addEventListener("keydown",function(e){e.ctrlKey&&e.key==="k"&&(e.preventDefault(),sInput.focus())})